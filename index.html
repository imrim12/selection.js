<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + TS</title>
  </head>
  <body>
    <div id="app">
      <h1>SelectJS playground</h1>
      <div>
        <label>
          Input:
          <input type="text" value="Hello World from input" />
        </label>
      </div>
      <div>
        <label>
          Textarea:
          <textarea>Hello World from textarea</textarea>
        </label>
      </div>
      <div>
        <label>
          Editor with contenteditable:
          <div contenteditable style="max-width: 400px">
            Hello <b>World from contenteditable</b> Lorem ipsum dolor sit amet
            consectetur adipisicing elit. Dolorum, neque id saepe similique
            libero, accusantium est sed dolore itaque labore esse architecto,
            repellendus dolores excepturi dolor. Ex quos voluptates accusantium.
          </div>
        </label>
      </div>
    </div>
    <script type="module">
      // Just an example, this project does not depend on Vue
      import { createApp, ref, onMounted } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js'
      import { setSelection, getSelectionRect, setHighlight, replaceSelectionContent, watchSelection } from './src/index'

      function waitFor(time = 0) {
        return new Promise((r) => setTimeout(r, time))
      }

      createApp({
        setup() {
          const message = ref('Hello vue!')
          
          const wait = false
          
          onMounted(async () => {
            const input$ = document.querySelector('input')
            const textarea$ = document.querySelector('textarea')
            const contenteditable$ = document.querySelector('[contenteditable]')

            // setSelection(input$, { start: 0, end: 5, keep: true })
            // wait && await waitFor(1000)
            // const selectionInputRect = getSelectionRect(input$)
            // setHighlight(input$, selectionInputRect.children)

            // wait && await waitFor(3000)

            // setSelection(textarea$, { start: 0, end: 5, keep: true })
            // wait && await waitFor(1000)
            // const selectionTextareaRect = getSelectionRect(textarea$)
            // setHighlight(textarea$, selectionTextareaRect.children)

            // wait && await waitFor(3000)

            // setSelection(contenteditable$, { start: 15, end: 200, keep: true })
            // wait && await waitFor(1000)
            // const selectionContenteditableRect = getSelectionRect(contenteditable$)
            // // setHighlight(contenteditable$, selectionContenteditableRect.children)
            // wait && await waitFor(1000)
            // replaceSelectionContent('Hehe i dunno man')
            // wait && await waitFor(1000)
            // const selectionContenteditableRectNew = getSelectionRect(contenteditable$)
            // setHighlight(contenteditable$, selectionContenteditableRectNew.children)

            watchSelection(input$, (selection, selectionRect) => {
              console.log('input$',selection, selectionRect)
              setHighlight(input$, selectionRect.children)
            }, { keep: false, debounce: 300 })

            watchSelection(textarea$, (selection, selectionRect) => {
              console.log('textarea$', selection, selectionRect)
              setHighlight(textarea$, selectionRect.children)
            }, { keep: false })

            watchSelection(contenteditable$, (selection, selectionRect) => {
              console.log('contenteditable$', selection, selectionRect)
              setHighlight(contenteditable$, selectionRect.children)
            }, { keep: false })
          })

          return {}
        }
      }).mount('#app')
    </script>
  </body>
</html>
